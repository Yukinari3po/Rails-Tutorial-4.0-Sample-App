<% if signed_in? %>
	<%= render 'users/home_with_feed' %> 
<% else %>
	<div class="center hero-unit">
		<h1>Welcome to the Sample App</h1>

		<h2>
			This is the home page for the 
			<a href="http://railstutorial.jp/">Ruby on Rails Tutorial</a>
			sample application.
		</h2>

		<!-- チャット表示部分 -->
		<ul id="chat_area"></ul>

		<!-- コメントフォーム -->

		<input id="comment" type="text"> <input id="send" type="button" value="send">

		<script>
		  var ws_rails = new WebSocketRails("<%= request.raw_host_with_port + websocket_path %>");
		  // メッセージ受信時の処理
		  ws_rails.bind("websocket_chat", function(message){
		    var message_li = document.createElement("li");
		    message_li.textContent = message;
		    document.getElementById("chat_area").appendChild(message_li);
		  })
		  // メッセージ送信時の処理
		  document.getElementById("send").onclick =  function(){
			var comment = document.getElementById("comment").value;
			ws_rails.trigger("websocket_chat", comment);}
		</script>

		<%= link_to "Sign up now!", signup_path, class: "btn btn-large btn-primary" %>
	</div>

	<%= link_to image_tag("rails.png", alt: "Rails"), 'http://rubyonrails.org' %>
<% end %>